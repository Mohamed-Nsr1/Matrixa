// This is your Prisma schema file,
// Matrixa - Production SaaS for Egyptian High School Students

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// ============================================
// USER & AUTHENTICATION
// ============================================

/// User model - Core user entity with role-based access
model User {
  id            String    @id @default(cuid())
  email         String    @unique
  passwordHash  String
  role          UserRole  @default(STUDENT)
  
  // Profile Information
  fullName      String?
  avatarUrl     String?
  phone         String?  // Phone number for contact
  
  // Student-specific fields
  branchId      String?
  branch        Branch?   @relation(fields: [branchId], references: [id])
  specialization String?  // For Scientific: "science" or "math"
  secondLanguage String?  // "french" or "german"
  studyLanguage String?   // "arabic" or "english" - affects curriculum content
  uiLanguage    String    @default("arabic") // UI display language
  dailyStudyGoal Int?     // Minutes per day
  
  // Onboarding State
  onboardingCompleted Boolean @default(false)
  onboardingStep      Int     @default(0)
  
  // Notification Preferences
  studyReminders      Boolean @default(true)
  taskReminders       Boolean @default(true)
  pushSubscription    String? // JSON string for web push subscription
  
  // Ban Status
  isBanned     Boolean   @default(false)
  bannedAt     DateTime?
  bannedReason String?

  // Leaderboard Status
  hideFromLeaderboard Boolean @default(false) // Admin can hide from leaderboard
  
  // Device & Session
  deviceFingerprint String?
  lastActiveAt     DateTime @default(now())
  
  // Timestamps
  createdAt      DateTime  @default(now())
  updatedAt      DateTime  @updatedAt
  
  // Relations
  sessions       Session[]
  subscriptions  Subscription[]
  inviteCodeUsed InviteCode?  @relation("InviteCodeUsage")
  createdInvites InviteCode[] @relation("AdminCreatedInvites")
  tasks         Task[]
  notes         Note[]
  noteFolders   NoteFolder[]
  noteTags      NoteTag[]
  noteTemplates NoteTemplate[]
  focusSessions FocusSession[]
  streaks       Streak[]
  leaderboardEntry LeaderboardEntry?
  privateLessons PrivateLesson[]
  lessonProgress LessonProgress[]
  userBadges     UserBadge[]
  manualPaymentRequests ManualPaymentRequest[]

  @@index([email])
  @@index([role])
}

/// User roles for RBAC
enum UserRole {
  STUDENT
  ADMIN
}

/// Session model - For JWT refresh tokens and device tracking
model Session {
  id             String   @id @default(cuid())
  userId         String
  user           User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  refreshToken   String   @unique
  deviceFingerprint String
  userAgent      String?
  ipAddress      String?
  
  expiresAt      DateTime
  createdAt      DateTime @default(now())
  
  @@index([userId])
  @@index([refreshToken])
}

// ============================================
// INVITE CODE SYSTEM
// ============================================

/// Invite codes for registration control
model InviteCode {
  id          String    @id @default(cuid())
  code        String    @unique
  createdById String?
  createdBy   User?     @relation("AdminCreatedInvites", fields: [createdById], references: [id])
  
  maxUses     Int       @default(1)
  currentUses Int       @default(0)
  expiresAt   DateTime?
  isActive    Boolean   @default(true)
  
  usedBy      User?     @relation("InviteCodeUsage", fields: [usedById], references: [id])
  usedById    String?   @unique
  
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  
  @@index([code])
}

// ============================================
// SUBSCRIPTION SYSTEM
// ============================================

/// Subscription plans
model SubscriptionPlan {
  id          String   @id @default(cuid())
  name        String
  nameAr      String
  description String?
  descriptionAr String?
  
  price       Float    // Price in EGP
  durationDays Int     // Subscription duration in days
  
  features    String?  // JSON string of features
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  subscriptions Subscription[]
  manualPaymentRequests ManualPaymentRequest[]
}

/// User subscriptions
model Subscription {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  planId      String?
  plan        SubscriptionPlan? @relation(fields: [planId], references: [id])
  
  status      SubscriptionStatus @default(TRIAL)
  startDate   DateTime @default(now())
  endDate     DateTime?
  
  // Grace period - 7 days after expiration for users to renew without losing access
  gracePeriodEnd DateTime?
  
  trialStart  DateTime?
  trialEnd    DateTime?
  
  paymobOrderId   String?
  paymobPaymentId String?
  
  // Notification tracking
  expiryWarningSentAt DateTime?  // When 7-day warning was sent
  expiredNotificationSentAt DateTime?  // When expiry notification was sent
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([userId])
  @@index([status])
  @@index([endDate])
  @@index([gracePeriodEnd])
}

enum SubscriptionStatus {
  TRIAL
  ACTIVE
  EXPIRED
  CANCELLED
  PAUSED
}

// ============================================
// CURRICULUM STRUCTURE
// ============================================

/// Branch - Scientific or Literary
model Branch {
  id          String   @id @default(cuid())
  nameAr      String
  nameEn      String
  code        String   @unique  // "scientific" or "literary"
  description String?
  order       Int      @default(0)
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  subjects    Subject[]
  users       User[]
  
  @@index([code])
}

/// Subject - e.g., Arabic, Math, Physics
model Subject {
  id          String   @id @default(cuid())
  branchId    String
  branch      Branch   @relation(fields: [branchId], references: [id], onDelete: Cascade)
  
  nameAr      String
  nameEn      String
  code        String?  // Optional short code
  description String?
  color       String?  // Hex color for UI
  icon        String?  // Icon name
  order       Int      @default(0)
  xpPerLesson Int      @default(10)
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  units       Unit[]
  notes       Note[]
  
  @@index([branchId])
}

/// Unit - Group of lessons within a subject
model Unit {
  id          String   @id @default(cuid())
  subjectId   String
  subject     Subject  @relation(fields: [subjectId], references: [id], onDelete: Cascade)
  
  nameAr      String
  nameEn      String
  description String?
  order       Int      @default(0)
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  lessons     Lesson[]
  
  @@index([subjectId])
}

/// Lesson - Individual lesson within a unit
model Lesson {
  id          String   @id @default(cuid())
  unitId      String
  unit        Unit     @relation(fields: [unitId], references: [id], onDelete: Cascade)
  
  nameAr      String
  nameEn      String
  description String?
  order       Int      @default(0)
  duration    Int?     // Estimated duration in minutes
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  notes       Note[]
  tasks       Task[]
  lessonProgress LessonProgress[]
  
  @@index([unitId])
}

// ============================================
// STUDY PLANNING & TASKS
// ============================================

/// Task - Scheduled study task
model Task {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  lessonId    String?
  lesson      Lesson?  @relation(fields: [lessonId], references: [id], onDelete: SetNull)
  
  title       String
  description String?
  
  taskType    TaskType @default(VIDEO)
  status      TaskStatus @default(PENDING)
  
  scheduledDate DateTime? // The date this task is scheduled for
  dayOfWeek    Int?       // 0-6 (Sunday-Saturday) for weekly planner
  scheduledTime String?   // Time slot (e.g., "14:00")
  
  duration    Int       // Duration in minutes
  remainingDuration Int? // For paused sessions
  
  order       Int       @default(0) // Order within the day
  
  completedAt DateTime?
  
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  
  @@index([userId])
  @@index([scheduledDate])
  @@index([status])
}

enum TaskType {
  VIDEO
  QUESTIONS
  REVISION
}

enum TaskStatus {
  PENDING
  IN_PROGRESS
  COMPLETED
  SKIPPED
}

/// Lesson Progress - Track student progress on each lesson
model LessonProgress {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  lessonId    String
  lesson      Lesson   @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  
  doneVideo     Boolean @default(false)
  doneQuestions Boolean @default(false)
  doneRevision  Boolean @default(false)
  
  confidenceLevel ConfidenceLevel @default(MEDIUM)
  
  lastStudiedAt DateTime?
  timesStudied Int      @default(0)
  
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  
  @@unique([userId, lessonId])
  @@index([userId])
  @@index([lessonId])
}

enum ConfidenceLevel {
  LOW
  MEDIUM
  HIGH
}

// ============================================
// FOCUS SESSIONS
// ============================================

/// Focus Session - Pomodoro-style study sessions
model FocusSession {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  taskId      String?
  
  startedAt   DateTime @default(now())
  endedAt     DateTime?
  duration    Int      // Planned duration in seconds
  actualDuration Int?  // Actual duration in seconds
  wasCompleted Boolean @default(false)
  
  brainDump   String?  // Notes during session
  notes       String?  // Additional notes after session
  
  // Session Progress Markers
  videosWatched     Int @default(0)
  questionsSolved   Int @default(0)
  revisionsCompleted Int @default(0)
  
  // Optional Subject/Lesson linking
  subjectId   String?
  lessonId    String?
  
  createdAt   DateTime @default(now())
  
  @@index([userId])
  @@index([startedAt])
  @@index([subjectId])
  @@index([lessonId])
}

// ============================================
// NOTES SYSTEM
// ============================================

/// Note Folder - Organize notes into folders
model NoteFolder {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  name        String
  color       String?  // Hex color
  icon        String?  // Emoji or icon name
  
  // Parent folder for nested structure
  parentId    String?
  parent      NoteFolder?  @relation("FolderHierarchy", fields: [parentId], references: [id], onDelete: Cascade)
  children    NoteFolder[] @relation("FolderHierarchy")
  
  order       Int      @default(0)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  notes       Note[]
  
  @@index([userId])
  @@index([parentId])
}

/// Note Tag - Tags for organizing notes
model NoteTag {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  name        String
  color       String?  // Hex color
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  notes       NoteTagRelation[]
  
  @@unique([userId, name])
  @@index([userId])
}

/// Note - Database-stored notes linked to subjects or lessons
model Note {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  subjectId   String?
  subject     Subject? @relation(fields: [subjectId], references: [id], onDelete: Cascade)
  lessonId    String?
  lesson      Lesson?  @relation(fields: [lessonId], references: [id], onDelete: Cascade)
  
  // Folder organization
  folderId    String?
  folder      NoteFolder? @relation(fields: [folderId], references: [id], onDelete: SetNull)
  
  title       String?
  content     String   // Rich text HTML content
  
  // Organization
  color       String?  // For color coding
  isPinned    Boolean  @default(false)
  isFavorite  Boolean  @default(false)
  isArchived  Boolean  @default(false)
  
  // Statistics
  wordCount   Int      @default(0)
  readingTime Int      @default(0)  // In minutes
  
  // Timestamps
  lastViewedAt DateTime?
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // Tags relation
  tags        NoteTagRelation[]
  
  @@index([userId])
  @@index([subjectId])
  @@index([lessonId])
  @@index([folderId])
  @@index([isPinned])
  @@index([isFavorite])
  @@index([isArchived])
}

/// Many-to-many relation between Notes and Tags
model NoteTagRelation {
  id        String   @id @default(cuid())
  noteId    String
  tagId     String
  
  note      Note     @relation(fields: [noteId], references: [id], onDelete: Cascade)
  tag       NoteTag  @relation(fields: [tagId], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now())
  
  @@unique([noteId, tagId])
  @@index([noteId])
  @@index([tagId])
}

/// Note Template - Reusable note templates
model NoteTemplate {
  id          String   @id @default(cuid())
  userId      String?  // Null for system templates
  user        User?    @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  name        String
  nameAr      String?
  description String?
  descriptionAr String?
  
  content     String   // Template content with placeholders
  
  // Template type
  type        TemplateType @default(GENERAL)
  
  isSystem    Boolean  @default(false)  // System templates available to all
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([userId])
  @@index([type])
  @@index([isSystem])
}

enum TemplateType {
  GENERAL
  CORNELL      // Cornell Notes method
  MINDMAP      // Mind map structure
  SUMMARY      // Summary template
  FLASHCARD    // Flashcard format
  STUDY_GUIDE  // Study guide format
}

// ============================================
// PRIVATE LESSONS / CENTERS
// ============================================

/// Private Lesson - External lessons at centers or with teachers
model PrivateLesson {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  subjectId   String?  // Optional link to subject
  
  teacherName String
  subjectName String   // Subject name (can be different from curriculum subjects)
  centerName  String?  // Center/school name
  
  // Schedule
  daysOfWeek  String   // JSON array: [0,1,2] for Sunday, Monday, Tuesday
  time        String   // e.g., "14:00"
  duration    Int      // Duration in minutes
  location    String?  // Physical location/room
  
  notes       String?
  color       String?
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([userId])
}

// ============================================
// ENGAGEMENT SYSTEMS
// ============================================

/// Streak - Daily activity tracking
model Streak {
  id          String   @id @default(cuid())
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  currentStreak Int    @default(0)
  longestStreak  Int   @default(0)
  lastActivityDate DateTime?
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@unique([userId])
  @@index([currentStreak])
}

/// Leaderboard Entry - For competition features
model LeaderboardEntry {
  id          String   @id @default(cuid())
  userId      String   @unique
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  score       Int      @default(0)
  rank        Int?
  
  // Score components
  studyMinutes    Int @default(0)
  tasksCompleted  Int @default(0)
  focusSessions   Int @default(0)
  
  isOptedIn   Boolean  @default(true)
  isHidden    Boolean  @default(false) // Admin can hide from leaderboard
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([score])
  @@index([rank])
}

// ============================================
// SYSTEM SETTINGS
// ============================================

/// System Settings - Feature flags and configuration
model SystemSettings {
  id          String   @id @default(cuid())
  key         String   @unique
  value       String   // JSON value
  
  description String?
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([key])
}

// ============================================
// PASSWORD RESET TOKENS
// ============================================

/// Password Reset Token - Secure database-stored reset tokens
model PasswordResetToken {
  id          String   @id @default(cuid())
  email       String   // User email
  token       String   @unique // Secure random token
  expiresAt   DateTime // Token expiration
  
  usedAt      DateTime? // When token was used (for tracking)
  
  createdAt   DateTime @default(now())
  
  @@index([email])
  @@index([token])
  @@index([expiresAt])
}

// ============================================
// AUDIT LOG
// ============================================

/// Audit Log - Track important actions for debugging and security
model AuditLog {
  id          String   @id @default(cuid())
  userId      String?
  action      String
  entityType  String?
  entityId    String?
  
  oldValue    String?  // JSON
  newValue    String?  // JSON
  
  ipAddress   String?
  userAgent   String?
  
  createdAt   DateTime @default(now())
  
  @@index([userId])
  @@index([action])
  @@index([createdAt])
}

// ============================================
// ANNOUNCEMENTS
// ============================================

/// Announcement - System-wide announcements for students
model Announcement {
  id          String   @id @default(cuid())
  
  title       String
  titleEn     String?  // English version
  content     String   // Arabic content
  contentEn   String?  // English version
  
  type        AnnouncementType @default(INFO)
  priority    Int      @default(0)  // Higher = more important
  
  // Targeting
  targetAll   Boolean  @default(true)
  targetBranches String? // JSON array of branch IDs
  
  // Display options
  showBanner  Boolean  @default(true)  // Show as banner at top
  isDismissible Boolean @default(true) // Allow users to dismiss
  
  // Scheduling
  startsAt    DateTime @default(now())
  endsAt      DateTime?
  
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([isActive])
  @@index([priority])
  @@index([startsAt])
}

enum AnnouncementType {
  INFO
  WARNING
  SUCCESS
  MAINTENANCE
  FEATURE
}

// ============================================
// GAMIFICATION BADGES
// ============================================

/// Badge - Achievement badges for gamification
model Badge {
  id          String   @id @default(cuid())

  nameAr      String   // Arabic name
  nameEn      String   // English name
  descriptionAr String?
  descriptionEn String?

  icon        String   // Emoji or icon name
  color       String   @default("#8b5cf6") // Hex color

  // Badge criteria
  type        BadgeType @default(STREAK)
  requirement Int      // e.g., 7 day streak, 100 tasks completed

  // Rarity
  rarity      BadgeRarity @default(COMMON)

  // XP reward for earning
  xpReward    Int      @default(0)

  isActive    Boolean  @default(true)
  order       Int      @default(0)

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  userBadges  UserBadge[]

  @@index([type])
  @@index([rarity])
}

enum BadgeType {
  STREAK        // Streak achievements
  TASKS         // Tasks completed
  FOCUS         // Focus sessions
  SUBJECTS      // Subject progress
  SPECIAL       // Special achievements
}

enum BadgeRarity {
  COMMON
  UNCOMMON
  RARE
  EPIC
  LEGENDARY
}

/// UserBadge - User's earned badges
model UserBadge {
  id          String   @id @default(cuid())

  userId      String
  badgeId     String

  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  badge       Badge    @relation(fields: [badgeId], references: [id], onDelete: Cascade)

  earnedAt    DateTime @default(now())

  // Progress tracking (for badges not yet earned)
  progress    Int      @default(0)  // Current progress
  isCompleted Boolean  @default(true)

  createdAt   DateTime @default(now())

  @@unique([userId, badgeId])
  @@index([userId])
  @@index([badgeId])
}

// ============================================
// EMAIL SYSTEM
// ============================================

/// Email Template - Reusable email templates for admin
model EmailTemplate {
  id          String   @id @default(cuid())

  name        String   // Internal name
  subject     String   // Email subject line
  subjectAr   String?  // Arabic subject
  
  // Email content (HTML)
  body        String   // HTML body with {{placeholders}}
  bodyAr      String?  // Arabic version
  
  // Template metadata
  type        EmailTemplateType @default(GENERAL)
  
  // Variables that can be used in this template (JSON array)
  variables   String?  // e.g., ["userName", "subscriptionEnd", "gracePeriodEnd"]
  
  // Trigger for automated emails
  trigger     EmailTrigger?  // What event triggers this email
  isActive    Boolean  @default(true)
  isSystem    Boolean  @default(false)  // System templates can't be deleted
  
  // Timing for automated emails (hours before/after trigger event)
  triggerOffset Int?   // e.g., -168 = 7 days before, 24 = 1 day after
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  emailLogs   EmailLog[]
  
  @@index([type])
  @@index([trigger])
  @@index([isActive])
}

enum EmailTemplateType {
  GENERAL       // General purpose
  SUBSCRIPTION  // Subscription related
  ONBOARDING    // New user onboarding
  ENGAGEMENT    // Re-engagement
  NOTIFICATION  // System notifications
}

enum EmailTrigger {
  TRIAL_STARTED       // When user starts trial
  TRIAL_ENDING        // Trial ending soon
  TRIAL_EXPIRED       // Trial expired
  SUBSCRIPTION_ACTIVE // Subscription activated
  SUBSCRIPTION_ENDING // Subscription ending soon
  SUBSCRIPTION_EXPIRED // Subscription expired
  GRACE_PERIOD_STARTED // Grace period started
  GRACE_PERIOD_ENDING // Grace period ending
  ACCESS_DENIED       // Access completely denied
  PAYMENT_SUCCESS     // Payment successful
  PAYMENT_FAILED      // Payment failed
  WELCOME             // New user welcome
}

/// Email Log - Track sent emails
model EmailLog {
  id          String   @id @default(cuid())
  
  templateId  String?
  template    EmailTemplate? @relation(fields: [templateId], references: [id], onDelete: SetNull)
  
  // Recipient info
  userId      String?
  email       String   // Recipient email
  userName    String?  // Recipient name
  
  // Email content (snapshot at send time)
  subject     String
  body        String
  
  // Status
  status      EmailStatus @default(PENDING)
  sentAt      DateTime?
  error       String?  // Error message if failed
  
  // Tracking
  openedAt    DateTime?
  clickedAt   DateTime?
  
  // Metadata
  metadata    String?  // JSON for additional data
  
  createdAt   DateTime @default(now())
  
  @@index([templateId])
  @@index([userId])
  @@index([email])
  @@index([status])
  @@index([createdAt])
}

enum EmailStatus {
  PENDING
  SENT
  FAILED
  BOUNCED
}

// ============================================
// MANUAL PAYMENT SYSTEM
// ============================================

/// Manual Payment Request - For Egyptian mobile wallets and InstaPay
model ManualPaymentRequest {
  id          String   @id @default(cuid())
  
  userId      String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  planId      String
  plan        SubscriptionPlan @relation(fields: [planId], references: [id])
  
  // Payment amount
  amount      Float    // Amount in EGP
  
  // Payment method
  paymentMethod   ManualPaymentMethod
  
  // Sender information (what the student filled)
  senderPhone     String?   // Phone number used for mobile wallet
  senderInstaPayUsername String?   // InstaPay username if used
  
  // Receipt/Screenshot
  receiptImageUrl String   // URL to uploaded receipt image
  
  // Status
  status      ManualPaymentStatus @default(PENDING)
  
  // Admin review
  reviewedBy  String?   // Admin user ID
  reviewedAt  DateTime?
  adminNotes  String?   // Notes from admin (visible to user)
  
  // Follow-up messages from admin
  followUpMessage String?   // If admin needs more info
  followUpSentAt  DateTime?
  
  // User response to follow-up
  userResponse    String?   // User's response/clarification
  userRespondedAt DateTime?
  
  // Additional receipt (if user re-uploads after follow-up)
  additionalReceiptUrl String?
  
  // Timestamps
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([userId])
  @@index([status])
  @@index([paymentMethod])
  @@index([createdAt])
}

enum ManualPaymentMethod {
  VODAFONE_CASH    // فودافون كاش
  ETISALAT_CASH    // اتصالات كاش
  ORANGE_CASH      // أورنج كاش
  INSTAPAY         // انستاباي
}

enum ManualPaymentStatus {
  PENDING          // Waiting for admin review
  APPROVED         // Approved, subscription activated
  REJECTED         // Rejected by admin
  NEEDS_INFO       // Admin needs more information
  INFO_PROVIDED    // User provided additional info
}

// ============================================
// LANDING PAGE CONTENT
// ============================================

/// Landing Page Content - Editable landing page sections
model LandingPageContent {
  id          String   @id @default(cuid())
  
  // Hero Section
  heroTitle       String?  // Main headline
  heroTitleEn     String?  // English version
  heroSubtitle    String?  // Subtitle text
  heroSubtitleEn  String?  // English version
  heroCtaText     String?  // CTA button text
  heroCtaTextEn   String?  // English version
  
  // Badge/Tagline
  badgeText       String?  // Small badge above hero (e.g., "مصمم خصيصاً لطلاب الثانوية المصرية")
  badgeTextEn     String?  // English version
  
  // Stats Section
  stat1Value      String?  // e.g., "10K+"
  stat1Label      String?  // e.g., "طالب نشط"
  stat1LabelEn    String?  // English version
  
  stat2Value      String?
  stat2Label      String?
  stat2LabelEn    String?
  
  stat3Value      String?
  stat3Label      String?
  stat3LabelEn    String?
  
  stat4Value      String?
  stat4Label      String?
  stat4LabelEn    String?
  
  // Features Section Title
  featuresTitle       String?
  featuresTitleEn     String?
  featuresSubtitle    String?
  featuresSubtitleEn  String?
  
  // CTA Section
  ctaTitle        String?
  ctaTitleEn      String?
  ctaSubtitle     String?
  ctaSubtitleEn   String?
  ctaButtonText   String?
  ctaButtonTextEn String?
  
  // Footer
  footerText      String?
  footerTextEn    String?
  
  // Timestamps
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

/// Landing Page Feature - Feature cards on landing page
model LandingPageFeature {
  id          String   @id @default(cuid())
  
  title       String   // Arabic title
  titleEn     String?  // English version
  description String   // Arabic description
  descriptionEn String? // English version
  icon        String   // Icon name (from lucide-react)
  color       String   @default("text-primary") // Tailwind color class
  
  order       Int      @default(0)
  isActive    Boolean  @default(true)
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  @@index([order])
  @@index([isActive])
}
